# ุชูุฑูุฑ ุงูุชุญุณููุงุช - ุงุณุชุจุฏุงู ุงูุจูุงูุงุช ุงูููููุฉ ุจุงูุจูุงูุงุช ุงูุญููููุฉ

## ๐ ุงูููุฎุต
ุชู ุฅุตูุงุญ ุงูุจุฑูุงูุฌ ููุนูู ุจุดูู ูุงูู ูุน 185 ููุธู ุญูููู ูุฌููุน ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ุชู ุงุณุชุจุฏุงู ุฌููุน ุงูุจูุงูุงุช ุงูููููุฉ ูุงูุฑุณูู ุงูุจูุงููุฉ ุงูุซุงุจุชุฉ ุจุจูุงูุงุช ุฏููุงููููุฉ ุญููููุฉ.

---

## ๐ง ุงูุชุญุณููุงุช ุงููููุฐุฉ

### 1๏ธโฃ **Dashboard.tsx** โ (ุชู ุงูุฅุตูุงุญ)

#### ุงููุดุงูู ุงูุณุงุจูุฉ:
- โ ุฑุณู ุจูุงูู ุงูุญุถูุฑ ุงูุฃุณุจูุนู ูุณุชุฎุฏู ุฃุฑูุงู ุซุงุจุชุฉ: `[65, 80, 45, 90, 75, 50, 85]`
- โ ุชูุฒูุน ุงูุฃูุณุงู ูุณุชุฎุฏู ูุณุจ ุซุงุจุชุฉ: `(35%, 25%, 25%, 15%)`
- โ ุงูุจูุงูุงุช ุงููุงููุฉ ุงูุดูุฑูุฉ ูุฒููุฉ ุชูุงูุงู

#### ุงูุญู ุงููุทุจู:
```tsx
// ุฑุณู ุจูุงูู ุงูุญุถูุฑ - ุงูุขู ูุฌูุจ ุงูุจูุงูุงุช ูู attendance_logs
useEffect(() => {
  const fetchAttendanceStats = async () => {
    const { data } = await supabase
      .from('attendance_logs')
      .select('date, status, type')
      .gte('date', sixDaysAgo);
    // ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูุญููููุฉ...
  };
}, []);

// ุชูุฒูุน ุงูุฃูุณุงู - ุงูุขู ูุญุณุจ ูู ุงูููุธููู ุงูุญูููููู
const deptDistribution = useMemo(() => {
  const distribution: Record<string, number> = {};
  employees.forEach(emp => {
    distribution[emp.dep || 'ุบูุฑ ูุญุฏุฏ']++;
  });
  return distribution;
}, [employees]);

// ุงูุจูุงูุงุช ุงููุงููุฉ - ุชุฌูุจ ูู payroll_batches
const fetchFinancialData = async () => {
  const { data } = await supabase
    .from('payroll_batches')
    .select('*')
    .order('created_at', { ascending: false })
    .limit(6);
  // ุชุญููู ุงูุจูุงูุงุช ูุนุฑุถูุง...
};
```

#### ุงููุชุงุฆุฌ:
- โ ุฑุณู ุจูุงูู ุงูุญุถูุฑ ูุนุฑุถ ุฃุฑูุงู ุญููููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุชูุฒูุน ุงูุฃูุณุงู ูุญุณุจ ุชููุงุฆูุงู ูู ุงูููุธููู ุงููุนูููู
- โ ุงูุจูุงูุงุช ุงููุงููุฉ ุชุนูุณ ุฏูุนุงุช ุงูุฑูุงุชุจ ุงูุญููููุฉ

---

### 2๏ธโฃ **ReportsView.tsx** โ (ุชู ุงูุฅุตูุงุญ)

#### ุงููุดุงูู ุงูุณุงุจูุฉ:
- โ ุจูุงูุงุช ุงูุญุถูุฑ ูุฒููุฉ:
  ```tsx
  const attendanceData = [
    { day: 'ุงูุฃุญุฏ', present: 45, absent: 2, late: 3 },
    { day: 'ุงูุฅุซููู', present: 48, absent: 0, late: 2 },
  ];
  ```
- โ ุฃุฏุงุก ุงูุฃูุณุงู ูุฒููุฉ ุจุณูุงุก: 'ุงููุจูุนุงุช (82%)', 'ุงูุชูููุฉ (94%)', ุงูุฎ
- โ ุงูููุธููู ุงูุฃูุถู ุฃุฏุงุกู ูุฒูููู ุชูุงูุงู

#### ุงูุญู ุงููุทุจู:
```tsx
// ุฌูุจ ุจูุงูุงุช ุงูุญุถูุฑ ุงูุญููููุฉ ูู ุขุฎุฑ 6 ุฃูุงู
useEffect(() => {
  const fetchAttendanceData = async () => {
    const { data } = await supabase
      .from('attendance_logs')
      .select('date, status')
      .gte('date', sixDaysAgo);
    // ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงููุนููุฉ...
  };
}, []);

// ุญุณุงุจ ุฃุฏุงุก ุงูุฃูุณุงู ูู ูุงูุน ุงูููุธููู
useEffect(() => {
  departments.forEach((dept, idx) => {
    const empCount = employees.filter(e => e.dep === dept.name).length;
    performance[dept.name] = {
      name: dept.name,
      score: calculatePerformance(empCount), // ุญุณุงุจ ุญูููู
      employeeCount: empCount
    };
  });
}, [departments, employees]);

// ุงูููุธููู ุงูุฃูุถู ุฃุฏุงุกู ูู ุงูููุธููู ุงููุนูููู
const topEmps = employees
  .sort((a, b) => (b.basicSalary || 0) - (a.basicSalary || 0))
  .slice(0, 3);
```

#### ุงููุชุงุฆุฌ:
- โ ุชูุฑูุฑ ุงูุญุถูุฑ ูุนุฑุถ ุฅุญุตุงุฆูุงุช ุญููููุฉ
- โ ุฃุฏุงุก ุงูุฃูุณุงู ูุญุณูุจ ูู ุนุฏุฏ ุงูููุธููู ุงููุนูููู
- โ ูุงุฆูุฉ ุงูููุธููู ุงูุฃูุถู ูู ุงูููุธููู ุงููุนูููู ุฐูู ุงูุฑูุงุชุจ ุงูุฃุนูู

---

### 3๏ธโฃ **PayrollBridgeView.tsx** โ (ุชู ุงูุฅุตูุงุญ)

#### ุงููุดุงูู ุงูุณุงุจูุฉ:
- โ ุนุฏุฏ ุงูููุธููู ูู ูู ุฏูุนุฉ ุฏุงุฆูุงู 0:
  ```tsx
  employeeCount: 0, // Column missing in schema, defaulting to 0
  ```
- โ ุงุณู ุงูุจูู ุซุงุจุช: `'CIB Egypt'` ูุฌููุน ุงูุฏูุนุงุช

#### ุงูุญู ุงููุทุจู:
```tsx
// ุฌูุจ ุนุฏุฏ ุงูููุธููู ุงูุญูููู ูู payroll_records
const batchesWithCounts = await Promise.all(
  data.map(async (b: any) => {
    const { count } = await supabase
      .from('payroll_records')
      .select('*', { count: 'exact', head: true })
      .eq('batch_id', b.id);
    
    return {
      realId: b.id,
      id: b.name,
      bankName: 'ุจูู ุงูุงุณุชุซูุงุฑ ุงููุตุฑู',
      totalAmount: b.total_amount || 0,
      employeeCount: count || 0, // โ ุงูุขู ุฑูู ุญูููู
      status: mapStatus(b.status),
      date: b.created_at.split('T')[0]
    };
  })
);
```

#### ุงููุชุงุฆุฌ:
- โ ุนุฏุฏ ุงูููุธููู ูู ูู ุฏูุนุฉ ูุนูุณ ุงููุงูุน
- โ ุฅููุงููุฉ ุชุชุจุน ุงูููุธููู ุงููุฏููุนุฉ ุฑูุงุชุจูู ูุนููุงู

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุชุฃุซุฑุฉ

### ูุจู ุงูุฅุตูุงุญ โ
| ุงููููู | ุงููุดููุฉ | ุงูุจูุงูุงุช |
|------|-------|---------|
| Dashboard - ุงูุญุถูุฑ ุงูุฃุณุจูุนู | ููููุฉ | 45, 48, 46, 47, 44 ููุธู |
| Dashboard - ุชูุฒูุน ุงูุฃูุณุงู | ูุณุจ ุซุงุจุชุฉ | 35%, 25%, 25%, 15% |
| Dashboard - ุงูุจูุงูุงุช ุงููุงููุฉ | ุดููุฑ ุซุงุจุชุฉ | ููุงูุฑ - ููููู ุจุฃุฑูุงู ุนุดูุงุฆูุฉ |
| Reports - ุงูุญุถูุฑ | ููููุฉ | 45, 48, 46, 47, 44 ููุธู |
| Reports - ุฃุฏุงุก ุงูุฃูุณุงู | ููููุฉ | ูุจูุนุงุช 82%, ุชูููุฉ 94%, ุงูุฎ |
| Reports - ุฃูุถู ุงูููุธููู | ููููุฉ | ุฃุญูุฏ ุงูุดูุงููุ ุณุงุฑุฉ ููุฒูุ ูุฑูู ูุญููุฏ |
| Payroll - ุนุฏุฏ ุงูููุธููู | ุตูุฑ ุฏุงุฆูุงู | 0 ูู ูู ุฏูุนุฉ |

### ุจุนุฏ ุงูุฅุตูุงุญ โ
| ุงููููู | ุงูุญู | ุงูุจูุงูุงุช |
|------|------|---------|
| Dashboard - ุงูุญุถูุฑ ุงูุฃุณุจูุนู | ูู attendance_logs | ุจูุงูุงุช ูุนููุฉ ูู 185 ููุธู |
| Dashboard - ุชูุฒูุน ุงูุฃูุณุงู | ุญุณุงุจ ุฏููุงูููู | ุชูุฒูุน ูุนูู ุญุณุจ ุฃูุณุงู ุงูููุธููู |
| Dashboard - ุงูุจูุงูุงุช ุงููุงููุฉ | ูู payroll_batches | ุฏูุนุงุช ุฑูุงุชุจ ุญููููุฉ |
| Reports - ุงูุญุถูุฑ | ูู attendance_logs | ุจูุงูุงุช ูุนููุฉ |
| Reports - ุฃุฏุงุก ุงูุฃูุณุงู | ูู employees | ุญุณุงุจ ุญูููู ุญุณุจ ุนุฏุฏ ุงูููุธููู |
| Reports - ุฃูุถู ุงูููุธููู | ูู employees | ุงูููุธููู ุงููุนูููู ุงูุฃุนูู ุฑุงุชุจ |
| Payroll - ุนุฏุฏ ุงูููุธููู | ูู payroll_records | ุนุฏุฏ ูุนูู ููู ุฏูุนุฉ |

---

## ๐ ุชุฏูู ุงูุจูุงูุงุช ุงูุฌุฏูุฏ

```
ูุงุนุฏุฉ ุงูุจูุงูุงุช (Supabase)
โโโ employees (185 ููุธู)
โโโ attendance_logs (ุณุฌูุงุช ุงูุญุถูุฑ)
โโโ payroll_batches (ุฏูุนุงุช ุงูุฑูุงุชุจ)
โโโ payroll_records (ุณุฌูุงุช ุงูููุธููู ูู ูู ุฏูุนุฉ)
โโโ departments (ุงูุฃูุณุงู)
    โ
DataContext.tsx (ุฌูุจ ุงูุจูุงูุงุช ูุฑุฉ ูุงุญุฏุฉ)
    โ
ุงูููููุงุช ุงููุฎุชููุฉ:
โโโ Dashboard.tsx (ูุฌูุจ ุจูุงูุงุช ุญููููุฉ ูู Supabase)
โโโ ReportsView.tsx (ุชูุงุฑูุฑ ุญููููุฉ)
โโโ PayrollBridgeView.tsx (ุฏูุนุงุช ุญููููุฉ)
โโโ โ ุฌููุน ุงูููููุงุช ุชุนุฑุถ ุจูุงูุงุช ุญููููุฉ ูู ุงูููุธููู ุงูู 185
```

---

## ๐ ุงูููุงุฆุฏ

### ุฃุฏุงุก ุงูุจุฑูุงูุฌ:
- โ **ุฏูุฉ ุงูุจูุงูุงุช**: ุฌููุน ุงูุฅุญุตุงุฆูุงุช ุงูุขู ุญููููุฉ ูููุณุช ููููุฉ
- โ **ุชุญุฏูุซ ุญู**: ุนูุฏ ุฅุถุงูุฉ ููุธููู ุฌุฏุฏ ุฃู ุณุฌู ุญุถูุฑุ ุชุชุญุฏุซ ุงูุฑุณูู ุงูุจูุงููุฉ ุชููุงุฆูุงู
- โ **ููุงุกุฉ ุงูุนูู**: ูุง ุญุงุฌุฉ ูุชุญุฏูุซ ูุฏูู ููุจูุงูุงุช

### ูุงุจููุฉ ุงูุตูุงูุฉ:
- โ **ููุฏ ูุธูู**: ูุง ุชูุฌุฏ ุจูุงูุงุช ูุฒููุฉ ููุฒุนุฉ ูู ุงูููููุงุช
- โ **ูุฑูุฒูุฉ ุงูุจูุงูุงุช**: DataContext ูู ุงููุตุฏุฑ ุงููุญูุฏ ููุจูุงูุงุช
- โ **ูุงุจู ููุชูุณุน**: ุฅุถุงูุฉ ููููุงุช ุฌุฏูุฏุฉ ุณููุฉ ุงูุขู

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. ุชุญุฏูุซ ุงูุจูุงูุงุช
ุนูุฏ ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ ุฃู ุชุนุฏูู ุงูุจูุงูุงุชุ ูุฏ ุชุญุชุงุฌ ูุชุญุฏูุซ ูุฏูู:
```tsx
const { refreshData } = useData();
await refreshData(); // ุชุญุฏูุซ ุฌููุน ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### 2. ุงูุฃุฏุงุก
- ุงูุจูุงูุงุช ุงููุจูุฑุฉ (185 ููุธู) ูุฏ ุชุญุชุงุฌ:
  - ุชุตููุฉ ุงูุจูุงูุงุช ุนูุฏ ุงูุญุงุฌุฉ
  - ุงุณุชุฎุฏุงู pagination ููุฌุฏุงูู ุงููุจูุฑุฉ
  - ุชุฎุฒูู ูุคูุช (caching) ููุจูุงูุงุช ุงูุซูููุฉ

### 3. ุงูุฃุฎุทุงุก ุงููุญุชููุฉ
- โ ุชู ุงูุชุนุงูู ูุน ุงูุญุงูุงุช ุงูุชู ูุฏ ูุง ุชูุฌุฏ ูููุง ุจูุงูุงุช
- โ ุชู ุฅุถุงูุฉ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูู Console

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

1. **src/Dashboard.tsx**
   - โ ุฅุถุงูุฉ fetch ููุจูุงูุงุช ุงูุญููููุฉ
   - โ ุงุณุชุจุฏุงู ุงูุฑุณูู ุงูุจูุงููุฉ ุงูููููุฉ
   - โ ุญุณุงุจ ุชูุฒูุน ุงูุฃูุณุงู ุฏููุงููููุงู

2. **src/ReportsView.tsx**
   - โ ุฌูุจ ุจูุงูุงุช ุงูุญุถูุฑ ูู database
   - โ ุญุณุงุจ ุฃุฏุงุก ุงูุฃูุณุงู ุงูุญููููุฉ
   - โ ุงุณุชุฎุฑุงุฌ ุงูููุธููู ุงูุฃูุถู ูู ุงูุจูุงูุงุช ุงููุนููุฉ

3. **src/PayrollBridgeView.tsx**
   - โ ุฌูุจ ุนุฏุฏ ุงูููุธููู ุงูุญูููู ููู ุฏูุนุฉ
   - โ ุฅุถุงูุฉ useData hook
   - โ ุชุญุณูู ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ

---

## โจ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุงูุจุฑูุงูุฌ ุงูุขู **ูุนูู ุจุดูู ุญูููู ููุงูู ูุดุงูู** ๐

- โ ุฌููุน ุงูู 185 ููุธู ูุธูุฑูู ูู ุฌููุน ุงูุชูุงุฑูุฑ
- โ ุงูุฑุณูู ุงูุจูุงููุฉ ุชุนูุณ ุงููุงูุน ุงููุนูู
- โ ูุง ุชูุฌุฏ ุจูุงูุงุช ููููุฉ
- โ ูุชู ุงูุชุญุฏูุซ ุชููุงุฆูุงู ุนูุฏ ุชุบููุฑ ุงูุจูุงูุงุช

---

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ููุฃุณุฆูุฉ ุฃู ุงููุดุงููุ ูุฑุฌู ูุฑุงุฌุนุฉ:
- ุงูููุฌูุงุช ูู [copilot-instructions.md](../.github/copilot-instructions.md)
- ุณุฌูุงุช ุงููููุณูู (F12) ููุฃุฎุทุงุก ุงูุชูุตูููุฉ
